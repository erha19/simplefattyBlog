!function(){"use strict";function t(t,e,n,o,r,a){o.html5Mode(!0),r.defaults.timeout=5e5,r.defaults.withCredentials=!0,r.interceptors.push("AuthInterceptor"),t.debugEnabled(a),n.otherwise("/")}function e(t,e,n,o,r,a){function i(t){var e=t.title;return angular.isUndefined(e)?n.title:e}n.$on("$stateChangeSuccess",function(n,o){if(!o||!(o.$$route||o).redirectTo){var r=i(o);console.log(r),a(function(){t.title=r,e[0].title=r},0,!0)}})}angular.module("sf_blog",["ui.router","ngTouch","ngSanitize","sf_blog.main","sf_blog.article","sf_blog.resources","sf_blog.directive","sf_blog.service"]).config(t).run(e),t.$inject=["$logProvider","$stateProvider","$urlRouterProvider","$locationProvider","$httpProvider","IsDebug"],e.$inject=["$window","$document","$rootScope","$location","$injector","$timeout"]}(),function(){"use strict";angular.module("sf_blog").component("sfNavbar",{templateUrl:"app/components/navbar/navbar.html"})}(),function(){"use strict";angular.module("sf_blog.main",[]).config(["$stateProvider",function(t){t.state("home",{url:"/",templateUrl:"app/components/main/main.html",controller:"MainController",controllerAs:"main",title:"Simplefatty|首页"})}])}(),function(){angular.module("sf_blog.main").directive("loadMore",["$timeout","$window","EVENT",function(t,e,n){return{restrict:"AE",link:function(o,r,a){angular.element(e).on("scroll",function(){var r=parseInt(document.body.scrollTop),a=parseInt(document.body.clientHeight);r>=a-e.screen.height+50&&t(function(){o.$emit(n.NeedToLoad)},200,!0)})}}}])}(),function(){"use strict";angular.module("sf_blog.main").filter("dataFilter",function(){return function(t,e){var n=new Date(t);return n.getFullYear()+"."+(n.getMonth()+1)+"."+n.getDate()}}).controller("MainController",["$scope","$timeout","Blog","Tags","EVENT",function(t,e,n,o,r){function a(o,r){t.isLoading=!0,n.getFrontBlogCount(o).then(function(e){t.blogCount=e.count,t.numPages=Math.ceil(t.blogCount/t.options.itemsPerPage)}),n.getFrontBlogList(o).then(function(n){for(var o in n.data){l=[];for(var a in n.data[o].tags)l.push(i[n.data[o].tags[a]]);c?n.data[o].image=n.data[o].images[0]:n.data[o].image=n.data[o].images[1],n.data[o].tagName=l.join(",")}e(function(){r?t.blogList=n.data:t.blogList=t.blogList.concat(n.data),t.isLoading=!1},0,!0)})["catch"](function(){t.isLoading=!1,t.blogList=[]})}var i={},l=[],c=function(){for(var t=navigator.userAgent,e=new Array("Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"),n=!0,o=0;o<e.length;o++)if(t.indexOf(e[o])>0){n=!1;break}return n}();t.isLoading=!0,o.getFrontTagList().then(function(e){for(var n in e.data)i[e.data[n]._id]=e.data[n].name;a(t.options)}),t.blogList=[],t.options={currentPage:1,itemsPerPage:10,sortName:"publish_time",tagId:""},t.$on(r.NeedToLoad,function(){t.options.currentPage*t.options.itemsPerPage<t.blogCount&&(t.isLoading=!0,t.options.currentPage++,a(t.options))})}])}(),function(){"use strict";angular.module("sf_blog").component("sfLoading",{templateUrl:"app/components/loading/loading.html"})}(),function(){"use strict";angular.module("sf_blog").component("sfFooter",{templateUrl:"app/components/footer/footer.html",controller:"footerCtrl",controllerAs:"footer"}).controller("footerCtrl",function(){this.info="Simplefatty ©2015-2016  粤ICP备16009462号"})}(),function(){"use strict";angular.module("sf_blog.article",[]).config(["$stateProvider",function(t){t.state("article",{url:"/article/:aid",templateUrl:"app/components/article/article.html",controller:"ArticleCtrl",controllerAs:"artical",resolve:{stateTitle:["$stateParams","$rootScope","Blog",function(t,e,n){return n.getFrontArticle({id:t.aid}).then(function(t){return e.title=t.data.title,t.data.title})}]}})}])}(),function(){"use strict";angular.module("sf_blog.article").directive("comment",function(){return{restrict:"AE",template:'<div class="ds-thread" ng-transclude></div>',transclude:!0,scope:{article:"=article",title:"=",url:"="},link:function(t,e){var n=t.article,o=t.url,r=t.url,a=t.title,i=document.createElement("div");i.setAttribute("data-thread-key",n),i.setAttribute("data-url",o),i.setAttribute("data-title",a),i.setAttribute("data-author-key",r),DUOSHUO.EmbedThread(i),e.append(i)}}})}(),function(){"use strict";angular.module("sf_blog").component("sfBanner",{templateUrl:"app/components/banner/banner.html",controller:"bannerCtrl",controllerAs:"banner"}).controller("bannerCtrl",["$scope",function(){this.tags=["Front-End Developer","Designer","Programmer","Gamer","JavaScript Developer","HTML Developer","Web Programmer"]}]).directive("tagContent",["$timeout",function(t){return{template:'<span ng-bind="tagName"></span>',scope:{tags:"="},replace:!0,link:function(e,n,o,r){function a(){i()}function i(){e.tagName=e.tagName.slice(0,-1),e.tagName.length?t(i,50,!0):t(function(){l(c())},100,!0)}function l(n){e.tagName=n.substring(0,e.tagName.length+1),e.tagName.length!=n.length?t(function(){l(n)},100,!0):t(a,5e3,!0)}function c(){return e.tags[Math.floor(Math.random()*e.tags.length)]}e.tagName=e.tags[0],t(i,1e3,!0)}}}])}(),function(){"use strict";angular.module("sf_blog.article").controller("ArticleCtrl",["$rootScope","$scope","$state","Blog","$stateParams","$location","stateTitle",function(t,e,n,o,r,a,i){var l=this;l.aid=r.aid,l.url=a.$$absUrl,l.aid||n.go("home"),o.getFrontArticle({id:l.aid}).then(function(t){l.article=t.data,l.title=t.data.title}).then(function(){var t={id:l.aid,sortName:"publish_time",tagId:""};o.getPrenext(t).then(function(t){l.next=t.data.next||{},l.prev=t.data.prev||{}})})["catch"](function(){n.go("home")})}])}(),function(){"use strict";angular.module("sf_blog.service",["ngAnimate"])}(),function(){"use strict";angular.module("sf_blog.service").factory("AuthInterceptor",["$rootScope","$q","$location","$injector",function(t,e,n,o){return{}}])}(),function(){"use strict";angular.module("sf_blog.resources",["ngResource"])}(),function(){"use strict";angular.module("sf_blog.resources").factory("User",["$resource","ServerUrl",function(t,e){var n=t(e+"/users/:id/:controller",{id:"@_id"},{getCaptcha:{method:"GET",params:{id:"getCaptcha"}},get:{method:"GET",params:{id:"me"}},mdUser:{method:"PUT",params:{id:"mdUser"}},getUserProvider:{method:"GET",params:{id:"getUserProvider"}},snsLogins:{method:"GET",params:{id:"snsLogins"}}});return{get:n.get,getCaptcha:function(t){var e=t||angular.noop;return n.getCaptcha(function(t){return e(t)},function(t){return e(t)}).$promise},mdUser:function(t,e){var o=e||angular.noop;return n.mdUser(t,function(t){return o(t)},function(t){return o(t)}).$promise},getUserProvider:function(t){var e=t||angular.noop;return n.getUserProvider(function(t){return e(t)},function(t){return e(t)}).$promise},getLogins:function(t){var e=t||angular.noop;return n.snsLogins(function(t){return e(t)},function(t){return e(t)}).$promise}}}])}(),function(){"use strict";angular.module("sf_blog.resources").factory("Tags",["$resource","ServerUrl",function(t,e){var n=t(e+"/tags/:id/:controller",{id:"@_id"},{getFrontTagList:{method:"GET",params:{id:"getFrontTagList"}}});return{getFrontTagList:function(t){var e=t||angular.noop;return n.getFrontTagList(function(t){return e(t)},function(t){return e(t)}).$promise}}}])}(),function(){"use strict";angular.module("sf_blog.resources").factory("Comment",["$resource","ServerUrl",function(t,e){var n=t(e+"/comment/:id/:controller",{id:"@_id"},{getFrontCommentList:{method:"GET",params:{controller:"getFrontCommentList"}},addNewComment:{method:"POST",params:{id:"addNewComment"}},addNewReply:{method:"POST",params:{controller:"addNewReply"}},delReply:{method:"PUT",params:{controller:"delReply"}}});return{addNewComment:function(t,e){var o=e||angular.noop;return n.addNewComment(t,function(t){return o(t)},function(t){return o(t)}).$promise},getFrontCommentList:function(t,e){var o=e||angular.noop;return n.getFrontCommentList(t,function(t){return o(t)},function(t){return o(t)}).$promise},addNewReply:function(t,e,o){var r=o||angular.noop;return n.addNewReply({id:t},e,function(t){return r(t)},function(t){return r(t)}).$promise},delComment:function(t,e){var o=e||angular.noop;return n.remove(t,function(t){return o(t)},function(t){return o(t)}).$promise},delReply:function(t,e,o){var r=o||angular.noop;return n.delReply({id:t},e,function(t){return r(t)},function(t){return r(t)}).$promise}}}])}(),function(){"use strict";angular.module("sf_blog.resources").factory("Blog",["$resource","ServerUrl",function(t,e){var n=t(e+"/article/:id/:controller",{id:"@_id"},{getFrontBlogList:{method:"GET",params:{id:"getFrontArticleList"}},getFrontBlogCount:{method:"GET",params:{id:"getFrontArticleCount"}},getFrontArticle:{method:"GET",params:{controller:"getFrontArticle"}},getIndexImage:{method:"GET",params:{id:"getIndexImage"}},toggleLike:{method:"PUT",params:{controller:"toggleLike"}},getPrenext:{method:"GET",params:{controller:"getPrenext"}}});return{getFrontBlogList:function(t,e){var o=e||angular.noop;return n.getFrontBlogList(t,function(t){return o(t)},function(t){return o(t)}).$promise},getFrontBlogCount:function(t,e){var o=e||angular.noop;return n.getFrontBlogCount(t,function(t){return o(t)},function(t){return o(t)}).$promise},getFrontArticle:function(t,e){var o=e||angular.noop;return n.getFrontArticle(t,function(t){return o(t)},function(t){return o(t)}).$promise},getIndexImage:function(t){var e=t||angular.noop;return n.getIndexImage(function(t){return e(t)},function(t){return e(t)}).$promise},toggleLike:function(t,e){var o=e||angular.noop;return n.toggleLike(t,{},function(t){return o(t)},function(t){return o(t)}).$promise},getPrenext:function(t,e){var o=e||angular.noop;return n.getPrenext(t,function(t){return o(t)},function(t){return o(t)}).$promise}}}])}(),function(){"use strict";angular.module("sf_blog.directive",[])}(),function(){"use strict";angular.module("sf_blog.directive").directive("lazyContainer",[function(){function t(t){var n=t.data("__uid");return n||t.data("__uid",n=""+ ++e),n}var e=0;return{restrict:"EA",controller:["$scope","$element",function(e,n){function o(){var e=angular.element(this),n=t(e);e.css("opacity",1),i.hasOwnProperty(n)&&delete i[n]}function r(t){var e,o,r=n[0].getBoundingClientRect(),a=t[0].getBoundingClientRect(),i=50;return a.bottom+i>=r.top&&a.top-i<=r.bottom&&(o=!0),a.right+i>=r.left&&a.left-i<=r.right&&(e=!0),e&&o}function a(){Object.keys(i).forEach(function(t){var e=i[t],n=e.iElement,o=e.iScope;r(n)&&n.attr("src",o.lazySrc)})}var i={};this.addImg=function(e,n,a){n.bind("load",o),e.$watch("lazySrc",function(){var o="1s";if(null!=e.animateSpeed&&(o=e.animateSpeed),r(n))e.animateVisible&&n.css({"background-color":"#fff",opacity:0,"-webkit-transition":"opacity "+o,transition:"opacity "+o}),n.attr("src",e.lazySrc);else{var a=t(n);n.css({"background-color":"#fff",opacity:0,"-webkit-transition":"opacity "+o,transition:"opacity "+o}),i[a]={iElement:n,iScope:e}}}),e.$on("$destroy",function(){n.unbind("load");var e=t(n);i.hasOwnProperty(e)&&delete i[e]})},n.bind("scroll",a),n.bind("resize",a)}]}}]).directive("lazySrc",[function(){return{restrict:"A",require:"^lazyContainer",scope:{lazySrc:"@",animateVisible:"@",animateSpeed:"@"},link:function(t,e,n,o){o.addImg(t,e,n)}}}])}(),function(){return angular.module("sf_blog").constant("ServerUrl","/api").constant("IsDebug",!1).constant("CookieConfig",{domain:"sf_blog"}).constant("EVENT",{NeedToLoad:"need-to-load"})}(),angular.module("sf_blog").run(["$templateCache",function(t){t.put("app/components/article/article.html",'<div class="sf_artical_content clearfix"><markdown class="markdown col-sm-offset-2 col-sm-8 scale-fade" ng-show="artical.article.content" data-ng-bind-html="::artical.article.content"></markdown><comment article="artical.aid" title="artical.title" url="artical.url"></comment></div>'),t.put("app/components/banner/banner.html",'<div class="sf_banner"><h1><span class="logo-tag">&lt;</span><tag-content tags="banner.tags"></tag-content><span class="text-cursor">|</span> <span class="logo-tag">/&gt;</span></h1><h2>Simplefatty</h2></div>'),t.put("app/components/footer/footer.html",'<div class="sf_footer" ng-bind="::footer.info"></div>'),t.put("app/components/loading/loading.html",'<div class="ball"></div><div class="ball"></div><div class="ball"></div>'),t.put("app/components/main/main.html",'<sf-banner class="slide-top"></sf-banner><div class="container sf_container" lazy-container=""><div class="row slide-top" data-ng-repeat="blog in blogList"><div class="col-sm-offset-1 col-sm-10 sf_artical_item"><img lazy-src="{{blog.image}}" class="img-responsive" animate-visible="true" animate-speed="0.5s" alt="{{::blog.title}}"><h1 ui-sref="article({aid:blog._id})">{{::blog.title}}</h1><div class="artical_tag"><div class="tag icon-tag" data-ng-bind="::blog.tagName"></div><div class="time icon-time" data-ng-bind="::blog.publish_time|dataFilter"></div></div><p data-ng-bind="::blog.introduce"></p></div></div><sf-loading class="loading" ng-show="isLoading" load-more=""></sf-loading></div>'),t.put("app/components/navbar/navbar.html",'<div class="sf_navbar bouncy-slide-top"><div class="container clearfix"><a href="" class="sf_logo"><img src="../assets/images/user_ic.png" alt=""></a><ul class="sf_nav pull-right"><li ui-sref-active="active"><a ui-sref="home">首页</a></li><li>实验室</li></ul></div></div>')}]);